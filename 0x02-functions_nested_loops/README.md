about functions, headers and nested loops